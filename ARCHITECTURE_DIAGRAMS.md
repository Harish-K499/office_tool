# VTAB Office Tool - Visual Architecture Diagrams

## 1. Overall System Architecture

```
                    ┌─────────────────────────────────────────────────────┐
                    │                    CLOUD INFRA                     │
                    │                                                     │
    ┌───────────────┼─────────────────────┬─────────────────────────────┼───────────────┐
    │               │                     │                             │               │
    ▼               ▼                     ▼                             ▼               ▼
┌─────────┐   ┌─────────────┐   ┌─────────────────┐   ┌─────────────┐   ┌─────────────┐
│ Netlify │   │   Render    │   │     Render      │   │ Microsoft   │   │   Google    │
│ (Front- │   │  (Backend)  │   │ (Socket Server) │   │ Dataverse   │   │    APIs     │
│  end)   │   │             │   │                 │   │             │   │             │
│         │   │             │   │                 │   │             │   │             │
│ • SPA   │   │ • Flask API │   │ • Node.js       │   │ • Employee  │   │ • Meet      │
│ • Vite  │   │ • JWT Auth  │   │ • Socket.IO     │   │   Data      │   │ • Gemini AI │
│ • TS/JS │   │ • MSAL O365 │   │ • Real-time     │   │ • Attendance│   │ • Gmail     │
└────┬────┘   └──────┬──────┘   └────────┬────────┘   └──────┬──────┘   └──────┬──────┘
     │                 │                    │                    │                 │
     │                 │                    │                    │                 │
     └─────────────────┼────────────────────┼────────────────────┼─────────────────┘
                       │                    │                    │
                       ▼                    ▼                    ▼
                ┌─────────────────────────────────────────────────────┐
                │                 USER DEVICES                       │
                │                                                     │
                │  ┌─────────┐    ┌─────────┐    ┌─────────┐        │
                │  │ Laptop  │    │  Mobile │    │  Tablet │        │
                │  │ Browser │    │ Browser │    │ Browser │        │
                │  └─────────┘    └─────────┘    └─────────┘        │
                └─────────────────────────────────────────────────────┘
```

## 2. Authentication Flow Diagram

```
┌──────────┐       1. Login Request       ┌─────────────┐
│  User    │─────────────────────────────►│   Frontend  │
│ Browser  │                              │             │
└──────────┘                              └──────┬──────┘
                                                │
                                                ▼
                                        2. POST /api/login
                                                │
                                                ▼
┌───────────────────────────────────────────────────────────────┐
│                        Backend (Flask)                        │
│                                                               │
│  ┌─────────────┐    3. Verify    ┌─────────────────┐         │
│  │   JWT       │◄───────────────►│   Dataverse     │         │
│  │ Middleware  │                 │   (OData)       │         │
│  └──────┬──────┘                 └────────┬────────┘         │
│         │                                   │                 │
│         │ 4. Valid Credentials               │                 │
│         ▼                                   ▼                 │
│  ┌─────────────┐    5. Create     ┌─────────────────┐         │
│  │    JWT      │─────────────────►│   JWT Token     │         │
│  │   Token     │                 │                 │         │
│  └──────┬──────┘                 └────────┬────────┘         │
│         │                                   │                 │
└─────────┼───────────────────────────────────┼─────────────────┘
          │ 6. Return JWT                       │
          ▼                                   ▼
┌───────────────────────────────────────────────────────────────┐
│                      Frontend Browser                        │
│                                                               │
│  ┌─────────────┐    7. Store     ┌─────────────────┐         │
│  │   Local     │◄───────────────►│   JWT Token     │         │
│  │  Storage    │                 │   (state.js)    │         │
│  └──────┬──────┘                 └────────┬────────┘         │
│         │                                   │                 │
│         │ 8. Include in all requests         │                 │
│         ▼                                   ▼                 │
│  ┌─────────────┐    9. API Call   ┌─────────────────┐         │
│  │Authorization:│────────────────►│   Backend API   │         │
│  │Bearer <JWT>  │                 │                 │         │
│  └─────────────┘                 └─────────────────┘         │
└───────────────────────────────────────────────────────────────┘
```

## 3. Real-time Communication Flow

```
┌──────────┐                           ┌──────────┐
│ User A   │                           │ User B   │
│ Browser  │                           │ Browser  │
└─────┬────┘                           └─────┬────┘
      │                                       │
      │ 1. Socket.IO Connection                │
      ├──────────────────────────────────────►│
      │                                       │
      │ 2. Join Room ('chat_123')              │
      ├──────────────────────────────────────►│
      │                                       │
      │ 3. Send Message                       │
      ├───────────────────────┐               │
      │                       │               │
      ▼                       ▼               ▼
┌───────────────────────────────────────────────────────┐
│              Socket Server (Node.js)                   │
│                                                       │
│  ┌─────────────┐    4. Save     ┌─────────────┐      │
│  │   Socket    │──────────────►│   Backend   │      │
│  │   Server    │                │   (Flask)   │      │
│  └──────┬──────┘                └──────┬──────┘      │
│         │ 5. Store Message              │            │
│         │                               │            │
│         ▼                               ▼            │
│  ┌─────────────┐    6. Broadcast  ┌─────────────┐   │
│  │   Socket    │◄───────────────│   Backend   │   │
│  │   Server    │                │  Response   │   │
│  └──────┬──────┘                └─────────────┘   │
│         │ 7. Emit to Room                             │
└─────────┼─────────────────────────────────────────────┘
          │
          │ 8. Broadcast Event
          ├──────────────────────────────────────►┐
          │                                      │
          ▼                                      ▼
┌───────────────────────────────────────────────────────┐
│                    All Clients                        │
│                                                       │
│  ┌─────────────┐    9. Update   ┌─────────────┐      │
│  │   User A    │◄───────────────│   User B    │      │
│  │   Chat UI   │                │   Chat UI   │      │
│  └─────────────┘                └─────────────┘      │
└───────────────────────────────────────────────────────┘
```

## 4. Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        LAYERED ARCHITECTURE                     │
├─────────────────────────────────────────────────────────────────┤
│                         PRESENTATION LAYER                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Web UI     │  │  Mobile UI   │  │  Desktop UI  │           │
│  │ (React/Vite) │  │   (Browser)  │  │ (Electron)   │           │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘           │
└─────────┼──────────────────┼──────────────────┼─────────────────┘
          │                  │                  │
          ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                      API GATEWAY LAYER                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Auth       │  │   Rate       │  │   Request    │           │
│  │  Middleware  │  │  Limiting    │  │ Validation   │           │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘           │
└─────────┼──────────────────┼──────────────────┼─────────────────┘
          │                  │                  │
          ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                      BUSINESS LOGIC LAYER                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Employee   │  │  Attendance  │  │    Leave     │           │
│  │   Service    │  │   Service    │  │   Service    │           │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘           │
└─────────┼──────────────────┼──────────────────┼─────────────────┘
          │                  │                  │
          ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                     DATA ACCESS LAYER                          │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   OData      │  │    MSAL      │  │   Cache      │           │
│  │   Client     │  │   Auth       │  │   Layer      │           │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘           │
└─────────┼──────────────────┼──────────────────┼─────────────────┘
          │                  │                  │
          ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                      PERSISTENCE LAYER                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │  Dataverse   │  │   File       │  │   External   │           │
│  │ (Primary DB) │  │  Storage     │  │   APIs       │           │
│  └──────────────┘  └──────────────┘  └──────────────┘           │
└─────────────────────────────────────────────────────────────────┘
```

## 5. Microservices Future State

```
┌─────────────────────────────────────────────────────────────────┐
│                     API GATEWAY (Kong)                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Auth       │  │   Router     │  │   Load       │           │
│  │  Service     │  │  Service     │  │  Balancer    │           │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘           │
└─────────┼──────────────────┼──────────────────┼─────────────────┘
          │                  │                  │
          ▼                  ▼                  ▼
┌─────────────────────────────────────────────────────────────────┐
│                    MICROSERVICES LAYER                         │
│                                                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌───────────┐ │
│  │   Auth      │ │  Employee   │ │ Attendance  │ │   Chat    │ │
│  │  Service    │ │  Service    │ │  Service    │ │ Service   │ │
│  │ (Node.js)   │ │ (Python)    │ │ (Python)    │ │ (Node.js) │ │
│  └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └─────┬─────┘ │
│         │               │               │               │     │
└─────────┼───────────────┼───────────────┼───────────────┼─────┘
          │               │               │               │
          ▼               ▼               ▼               ▼
┌─────────────────────────────────────────────────────────────────┐
│                    EVENT BUS (RabbitMQ)                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐           │
│  │   Message    │  │   Queue      │  │   Exchange   │           │
│  │   Broker     │  │  Manager     │  │   Router     │           │
│  └──────────────┘  └──────────────┘  └──────────────┘           │
└─────────────────────────────────────────────────────────────────┘
          │               │               │
          ▼               ▼               ▼
┌─────────────────────────────────────────────────────────────────┐
│                      DATA LAYER                                 │
│  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌───────────┐ │
│  │   Postgres  │ │    Redis    │ │  Dataverse  │ │  MongoDB  │ │
│  │ (Relational)│ │  (Cache)    │ │ (Master)    │ │ (Logs)    │ │
│  └─────────────┘ └─────────────┘ └─────────────┘ └───────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 6. Security Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                    SECURITY LAYERS                              │
│                                                                 │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                 NETWORK SECURITY                    │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │    WAF      │  │    DDoS     │  │   SSL/TLS   │ │       │
│  │  │  Protection │  │ Protection  │  │ Encryption  │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                │                                │
│  ┌─────────────────────────────────────────────────────┐       │
│  │              APPLICATION SECURITY                   │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │     JWT     │  │   OAuth 2   │  │    RBAC     │ │       │
│  │  │   Tokens    │  │   (MSAL)    │  │  (Roles)    │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                │                                │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                 DATA SECURITY                        │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │ Encryption  │  │   Hashing   │  │   Auditing  │ │       │
│  │  │ at Rest     │  │ Passwords   │  │   Logs      │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────────────┘
```

## 7. Deployment Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                    PRODUCTION ENVIRONMENT                       │
│                                                                 │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                    CDN (CloudFlare)                 │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │   Static    │  │   Assets    │  │    Cache    │ │       │
│  │  │   Files     │  │  (JS/CSS)   │  │   Layer     │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                │                                │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                  LOAD BALANCER                       │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │   Health    │  │   SSL       │  │   Routing   │ │       │
│  │  │   Checks    │  │ Termination │  │   Rules     │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                │                                │
│  ┌─────────────────────────────────────────────────────┐       │
│  │              APPLICATION SERVERS                     │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │   Frontend  │  │   Backend   │  │   Socket    │ │       │
│  │  │ (Netlify)   │  │  (Render)   │  │  (Render)   │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                │                                │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                 DATABASE LAYER                       │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │  Dataverse  │  │   Redis     │  │   Backup    │ │       │
│  │  │ (Primary)   │  │  (Cache)    │  │   Storage   │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
│                                                                 │
│  ┌─────────────────────────────────────────────────────┐       │
│  │                MONITORING & LOGS                     │       │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐ │       │
│  │  │   Metrics   │  │   Logging   │  │   Alerts    │ │       │
│  │  │ (Prometheus)│  │ (ELK Stack) │  │ (PagerDuty) │ │       │
│  │  └─────────────┘  └─────────────┘  └─────────────┘ │       │
│  └─────────────────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────────────────┘
```

---

## Key Points to Remember:

1. **Three-Tier Architecture**: Presentation → Application → Data
2. **Microservices Ready**: Current monolith can be split easily
3. **Event-Driven**: Socket.IO enables real-time features
4. **Secure by Design**: Multiple security layers
5. **Cloud-Native**: Fully managed services
6. **Scalable**: Horizontal scaling possible
7. **Maintainable**: Clear separation of concerns
